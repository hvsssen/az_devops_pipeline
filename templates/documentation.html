<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure MCP DevOps Agent - Complete Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet">
    <link href="/static/style.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <strong>‚òÅÔ∏è Azure MCP DevOps Agent</strong>
            </a>
            {% if logged_in %}
                <span class="badge bg-success">‚úÖ Connected</span>
            {% else %}
                <span class="badge bg-warning">‚ö†Ô∏è Not Connected</span>
            {% endif %}
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Hero Section -->
        <div class="row">
            <div class="col-12">
                <div class="jumbotron bg-primary text-white p-5 rounded">
                    <h1 class="display-4">Azure MCP DevOps Agent</h1>
                    <p class="lead">A comprehensive Model Context Protocol (MCP) server with <strong>GitHub + Docker + Azure</strong> integration and Smart Port Detection.</p>
                    <hr class="my-4">
                    <p>üöÄ Complete DevOps Pipeline: GitHub ‚Üí Docker ‚Üí Azure with intelligent automation!</p>
                </div>
            </div>
        </div>

        <!-- Key Features -->
        <div class="row mt-5">
            <div class="col-12">
                <h2>üåü Complete DevOps Integration</h2>
                <div class="row mt-3">
                    <div class="col-md-3">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">üêô GitHub Integration</h5>
                                <p class="card-text">
                                    ‚Ä¢ OAuth authentication<br>
                                    ‚Ä¢ Repository management<br>
                                    ‚Ä¢ Automated cloning<br>
                                    ‚Ä¢ Branch operations
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">üê≥ Docker Deployment</h5>
                                <p class="card-text">
                                    ‚Ä¢ Smart port detection<br>
                                    ‚Ä¢ Automated builds<br>
                                    ‚Ä¢ Docker Hub push<br>
                                    ‚Ä¢ Container management
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">‚òÅÔ∏è Azure Cloud</h5>
                                <p class="card-text">
                                    ‚Ä¢ Azure CLI integration<br>
                                    ‚Ä¢ VM management<br>
                                    ‚Ä¢ Cost analysis<br>
                                    ‚Ä¢ Resource monitoring
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">ü§ñ MCP Protocol</h5>
                                <p class="card-text">
                                    ‚Ä¢ Standard interface<br>
                                    ‚Ä¢ Claude integration<br>
                                    ‚Ä¢ Tool-based API<br>
                                    ‚Ä¢ Extensible design
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Complete DevOps Workflow -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="alert alert-info">
                    <h4>üöÄ Complete DevOps Workflow</h4>
                    <p><strong>Your MCP server now provides end-to-end DevOps automation!</strong></p>
                    <div class="row">
                        <div class="col-md-6">
                            <h6>üìã Development Flow:</h6>
                            <ol class="mb-0">
                                <li>üêô <strong>GitHub:</strong> List, clone, manage repositories</li>
                                <li>üîç <strong>Smart Detection:</strong> Auto-detect ports and configurations</li>
                                <li>üê≥ <strong>Docker:</strong> Build, tag, and push images</li>
                                <li>‚òÅÔ∏è <strong>Azure:</strong> Deploy to cloud infrastructure</li>
                            </ol>
                        </div>
                        <div class="col-md-6">
                            <h6>üìä Operations & Monitoring:</h6>
                            <ul class="mb-0">
                                <li>üí∞ <strong>Cost Analysis:</strong> Track Azure spending</li>
                                <li>üñ•Ô∏è <strong>VM Management:</strong> Monitor virtual machines</li>
                                <li>üìà <strong>Usage Reports:</strong> Analyze resource consumption</li>
                                <li>üîß <strong>Resource Groups:</strong> Organize cloud resources</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Endpoints -->
        <div class="row mt-5">
            <div class="col-12">
                <h2>üîó Complete API Documentation</h2>
                <div class="accordion" id="apiAccordion">
                    <!-- GitHub Endpoints -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="githubHeading">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#githubCollapse">
                                üêô GitHub Integration APIs
                            </button>
                        </h2>
                        <div id="githubCollapse" class="accordion-collapse collapse show" data-bs-parent="#apiAccordion">
                            <div class="accordion-body">
                                <div class="table-responsive">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Method</th>
                                                <th>Endpoint</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/github/login</code></td>
                                                <td>Initiate GitHub OAuth login</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/github/repos</code></td>
                                                <td>List user repositories</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/clone</code></td>
                                                <td>Clone repository locally</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Docker Endpoints -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="dockerHeading">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#dockerCollapse">
                                üê≥ Docker & Container APIs
                            </button>
                        </h2>
                        <div id="dockerCollapse" class="accordion-collapse collapse" data-bs-parent="#apiAccordion">
                            <div class="accordion-body">
                                <div class="table-responsive">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Method</th>
                                                <th>Endpoint</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><span class="badge bg-success">POST</span></td>
                                                <td><code>/deploy</code></td>
                                                <td>Build and deploy Docker image</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/run_container</code></td>
                                                <td>üî• Run container with smart port detection</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/detect_ports</code></td>
                                                <td>üî• Analyze repository for exposed ports</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Azure Endpoints -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="azureHeading">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#azureCollapse">
                                ‚òÅÔ∏è Azure Cloud APIs
                            </button>
                        </h2>
                        <div id="azureCollapse" class="accordion-collapse collapse" data-bs-parent="#apiAccordion">
                            <div class="accordion-body">
                                <div class="table-responsive">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Method</th>
                                                <th>Endpoint</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/azure/login</code></td>
                                                <td>üÜï Launch Azure CLI login</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/azure/subscriptions</code></td>
                                                <td>üÜï List Azure subscriptions</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/azure/vms</code></td>
                                                <td>üÜï Get VM usage and cost analysis</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/azure/resource-groups</code></td>
                                                <td>üÜï List Azure resource groups</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-primary">GET</span></td>
                                                <td><code>/azure/vm-details</code></td>
                                                <td>üÜï Get detailed VM information</td>
                                            </tr>
                                            <tr>
                                                <td><span class="badge bg-success">POST</span></td>
                                                <td><code>/azure/command</code></td>
                                                <td>üÜï Execute Azure CLI commands</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Usage Examples -->
        <div class="row mt-5">
            <div class="col-12">
                <h2>üí° Complete DevOps Workflow Examples</h2>
                <div class="card">
                    <div class="card-body">
                        <h5>1. End-to-End Development & Deployment</h5>
                        <pre class="language-python"><code># Complete workflow: GitHub ‚Üí Docker ‚Üí Azure
# Step 1: GitHub Authentication & Repository Management
github_login = github_login_mcp_github_login_get()
repos = get_repositories_github_repos_get()
clone_result = clone_repository_clone_get(repo_url="https://github.com/user/webapp")

# Step 2: Smart Docker Build & Deploy
port_detection = detect_ports_endpoint(repo_path="repos/webapp") 
deploy_result = deploy_deploy_post({
    "repo_full_name": "user/webapp",
    "tag": "latest",
    "image_name": "webapp", 
    "repo_path": "repos/webapp"
})

# Step 3: Azure Cloud Management
azure_login = azure_login()
subscriptions = azure_subscriptions()
vm_usage = azure_vm_usage()

# Step 4: Run with Auto-Detection
container_result = run_docker_container(
    image="webapp",
    tag="latest", 
    repo_path="repos/webapp"
)</code></pre>

                        <h5 class="mt-4">2. Azure Cloud Operations</h5>
                        <pre class="language-python"><code># Azure resource management and monitoring
# Authentication
azure_login_response = azure_login()

# List subscriptions and resources
subscriptions = azure_subscriptions()
resource_groups = azure_resource_groups()

# VM management and cost analysis
vm_usage_data = azure_vm_usage()
vm_details = azure_vm_details(
    vm_name="my-vm", 
    resource_group="my-rg"
)

# Execute custom Azure CLI commands
command_result = azure_command_async(command="vm list --output table")</code></pre>

                        <h5 class="mt-4">3. Cost Monitoring & Analysis</h5>
                        <pre class="language-bash"><code># Get Azure cost and usage data
curl "http://localhost:8000/azure/vms"

# Response includes:
{
  "status": "ok",
  "vms": [...],           # List of all VMs
  "total_cost": 125.50,   # Total cost (last 30 days)
  "currency": "USD",      # Currency
  "debug": [...]          # Debug information
}</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Installation -->
        <div class="row mt-5 mb-5">
            <div class="col-12">
                <h2>üì¶ Installation & Setup</h2>
                <div class="card">
                    <div class="card-body">
                        <h5>Prerequisites</h5>
                        <ul>
                            <li>Python 3.8+</li>
                            <li>Docker installed and running</li>
                            <li>Azure CLI installed</li>
                            <li>Git</li>
                            <li>Docker Hub account</li>
                            <li>Azure subscription</li>
                        </ul>
                        
                        <h5 class="mt-4">Complete Setup</h5>
                        <pre class="language-bash"><code># 1. Clone the MCP server
git clone https://github.com/hvsssen/az_devops_pipeline.git
cd az_devops_pipeline/azure_mcp_agent_hassen

# 2. Install Python dependencies
pip install fastapi uvicorn python-dotenv httpx gitpython fastapi-mcp

# 3. Install Azure CLI (if not installed)
# Windows: https://aka.ms/installazurecliwindows
# macOS: brew install azure-cli
# Linux: curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash

# 4. Configure environment
echo "DOCKER_USERNAME=your_username" > .env
echo "DOCKER_PASSWORD=your_password" >> .env

# 5. Run the server
python server.py

# 6. Access documentation at http://localhost:8000</code></pre>

                        <h5 class="mt-4">üÜï What's New in This Conversion</h5>
                        <div class="alert alert-success">
                            <h6>‚úÖ Converted from standalone MCP to integrated utilities:</h6>
                            <ul class="mb-0">
                                <li><strong>Modular Design:</strong> Azure functions are now utility methods in <code>azure_utils.py</code></li>
                                <li><strong>REST API Integration:</strong> Azure endpoints added to main FastAPI server</li>
                                <li><strong>Pydantic Models:</strong> Type-safe request/response models for Azure operations</li>
                                <li><strong>Unified Interface:</strong> GitHub + Docker + Azure in one MCP server</li>
                                <li><strong>Session Management:</strong> Azure authentication persisted across requests</li>
                                <li><strong>Error Handling:</strong> Comprehensive error handling and logging</li>
                                <li><strong>Async Support:</strong> Asynchronous Azure CLI command execution</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white mt-5 py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <h5>‚òÅÔ∏è Azure MCP DevOps Agent</h5>
                    <p>Complete DevOps automation: GitHub + Docker + Azure</p>
                    <p class="text-muted">Built with FastAPI ‚Ä¢ Smart Port Detection ‚Ä¢ Azure Integration ‚Ä¢ Model Context Protocol</p>
                </div>
                <div class="col-md-4 text-end">
                    <p>
                        <a href="https://github.com/hvsssen/az_devops_pipeline" class="text-white">
                            üìÅ View on GitHub
                        </a>
                    </p>
                    <p>Status: {% if logged_in %}<span class="text-success">‚úÖ Connected</span>{% else %}<span class="text-warning">‚ö†Ô∏è Not Connected</span>{% endif %}</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
